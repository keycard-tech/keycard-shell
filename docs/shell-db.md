# Keycard Shell Database

The Keycard Shell Database contains data about Ethereum ABIs, Chains and ERC20 tokens. The script contained in `tools/shell-db.py` is able to generate the database binary files starting from JSON files. For details about the format of the input JSON files look at:

* Ethereum ABI: list of functions, as generated by the [Solidity compiler](https://docs.soliditylang.org/en/latest/abi-spec.html#json)
* Chainlist: format defined by [https://chainlist.org/](https://chainlist.org/)
* ERC20 List: format defined by [https://tokenlists.org/](https://tokenlists.org/)

You are able to reproduce the bin file used to update the database on your Keycard Shell by downloading the source JSON files from https://shell.keycard.tech/update/db-version-history and following the below instructions. The generated file will be identical to the one generated by us, except for the last 64 bytes which are the signature.

## Requirements

All commands in this guide assume you are in the keycard-shell repository. Adjust paths accordingly if needed.

You need to have Python >= 3.12 and install the dependencies with

`pip install -r tools/requirements.txt`

## Building the database

Once you have downloaded the source files for the database version you wish to reproduce, unzip the files and run the following command.

`python tools/shell-db.py -t /path/to/json/files/erc20.json -c /path/to/json/files/chain.json -a /path/to/json/files/abi.json -v VERSIONDATE -d -o db-out.bin`

you can then verify that the binary file included in the downloaded zip and file you just generated differ only in the last 64 bytes. The easiest way to do this is to run the included hashing tool (check the code, it just does SHA256 excluding the last 64 bytes) on both files and check that the output is the same.

`python tools/database-hash.py -b db-out.bin`

and

`python tools/database-hash.py -b /path/to/json/files/db.bin`
